#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

branch="$(git symbolic-ref --short HEAD 2>/dev/null || echo "")"

# Block direct pushes to main
if [ "$branch" = "main" ]; then
  echo "ðŸš« Direct pushes to main are blocked. Create a PR instead."
  exit 1
fi

# Ensure pnpm via corepack (works in Codex/CI too)
command -v corepack >/dev/null 2>&1 && corepack enable >/dev/null 2>&1 || true

echo "â–¶ Running project checks (typecheck + lint + build)â€¦"
pnpm typecheck && pnpm lint && pnpm build
